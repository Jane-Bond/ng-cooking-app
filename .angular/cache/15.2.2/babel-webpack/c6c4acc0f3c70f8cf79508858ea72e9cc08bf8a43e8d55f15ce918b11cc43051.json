{"ast":null,"code":"import { createEffect, ofType } from \"@ngrx/effects\";\nimport { map, switchMap, withLatestFrom } from \"rxjs/operators\";\nimport * as RecipesActions from \"./recipe.actions\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ngrx/effects\";\nimport * as i2 from \"@angular/common/http\";\nimport * as i3 from \"@ngrx/store\";\nexport class RecipeEffects {\n  constructor(actions$, http, store) {\n    this.actions$ = actions$;\n    this.http = http;\n    this.store = store;\n    this.fectRecipes = createEffect(() => this.actions$.pipe(ofType(RecipesActions.FETCH_RECIPES), switchMap(() => {\n      return this.http.get(\"https://angular-cooking-app-2a43c-default-rtdb.europe-west1.firebasedatabase.app/recipes.json\");\n    }), map(recipes => {\n      return recipes.map(recipe => {\n        return {\n          ...recipe,\n          ingredients: recipe.ingredients ? recipe.ingredients : []\n        };\n      });\n    }), map(recipes => {\n      return new RecipesActions.SetRecipes(recipes);\n    })));\n    this.storeRecipes = createEffect(() => this.actions$.pipe(ofType(RecipesActions.STORE_RECIPES), withLatestFrom(this.store.select(\"recipes\")), switchMap([actionData, recipesState], {\n      return: this.http.put(\"https://angular-cooking-app-2a43c-default-rtdb.europe-west1.firebasedatabase.app/recipes.json\", recipes)\n    })), {\n      dispatch: false\n    });\n  }\n}\nRecipeEffects.ɵfac = function RecipeEffects_Factory(t) {\n  return new (t || RecipeEffects)(i0.ɵɵinject(i1.Actions), i0.ɵɵinject(i2.HttpClient), i0.ɵɵinject(i3.Store));\n};\nRecipeEffects.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: RecipeEffects,\n  factory: RecipeEffects.ɵfac\n});","map":{"version":3,"mappings":"AACA,SAAkBA,YAAY,EAAEC,MAAM,QAAQ,eAAe;AAC7D,SAASC,GAAG,EAAEC,SAAS,EAAEC,cAAc,QAAQ,gBAAgB;AAC/D,OAAO,KAAKC,cAAc,MAAM,kBAAkB;;;;;AAOlD,OAAM,MAAOC,aAAa;EAsCxBC,YACUC,QAAiB,EACjBC,IAAgB,EAChBC,KAA8B;IAF9B,aAAQ,GAARF,QAAQ;IACR,SAAI,GAAJC,IAAI;IACJ,UAAK,GAALC,KAAK;IAxCf,gBAAW,GAAGV,YAAY,CAAC,MACzB,IAAI,CAACQ,QAAQ,CAACG,IAAI,CAChBV,MAAM,CAACI,cAAc,CAACO,aAAa,CAAC,EACpCT,SAAS,CAAC,MAAK;MACb,OAAO,IAAI,CAACM,IAAI,CAACI,GAAG,CAClB,+FAA+F,CAChG;IACH,CAAC,CAAC,EACFX,GAAG,CAAEY,OAAO,IAAI;MACd,OAAOA,OAAO,CAACZ,GAAG,CAAEa,MAAM,IAAI;QAC5B,OAAO;UACL,GAAGA,MAAM;UACTC,WAAW,EAAED,MAAM,CAACC,WAAW,GAAGD,MAAM,CAACC,WAAW,GAAG;SACxD;MACH,CAAC,CAAC;IACJ,CAAC,CAAC,EACFd,GAAG,CAAEY,OAAO,IAAI;MACd,OAAO,IAAIT,cAAc,CAACY,UAAU,CAACH,OAAO,CAAC;IAC/C,CAAC,CAAC,CACH,CACF;IAED,iBAAY,GAAGd,YAAY,CACzB,MACE,IAAI,CAACQ,QAAQ,CAACG,IAAI,CAChBV,MAAM,CAACI,cAAc,CAACa,aAAa,CAAC,EACpCd,cAAc,CAAC,IAAI,CAACM,KAAK,CAACS,MAAM,CAAC,SAAS,CAAC,CAAC,EAC5ChB,SAAS,CAAC,CAACiB,UAAU,EAAEC,YAAY,CAAC,EAAI;MACtCC,MAAM,EAAC,IAAI,CAACb,IAAI,CAACc,GAAG,CAClB,+FAA+F,EAC/FT,OAAO;KAEV,CAAC,CACH,EACH;MAAEU,QAAQ,EAAE;IAAK,CAAE,CACpB;EAME;;AA1CQlB,aAAa;mBAAbA,aAAa;AAAA;AAAbA,aAAa;SAAbA,aAAa;EAAAmB,SAAbnB,aAAa;AAAA","names":["createEffect","ofType","map","switchMap","withLatestFrom","RecipesActions","RecipeEffects","constructor","actions$","http","store","pipe","FETCH_RECIPES","get","recipes","recipe","ingredients","SetRecipes","STORE_RECIPES","select","actionData","recipesState","return","put","dispatch","factory"],"sourceRoot":"","sources":["/Users/evgeniabondar/Desktop/Git folder/ng-cooking-app/src/app/recipes/store/recipe.effects.ts"],"sourcesContent":["import { HttpClient } from \"@angular/common/http\";\nimport { Actions, createEffect, ofType } from \"@ngrx/effects\";\nimport { map, switchMap, withLatestFrom } from \"rxjs/operators\";\nimport * as RecipesActions from \"./recipe.actions\";\nimport { Recipe } from \"../recipe.model\";\nimport { Injectable } from \"@angular/core\";\nimport { Store } from \"@ngrx/store\";\nimport * as fromApp from \"../../store/app.reducer\";\n\n@Injectable()\nexport class RecipeEffects {\n  fectRecipes = createEffect(() =>\n    this.actions$.pipe(\n      ofType(RecipesActions.FETCH_RECIPES),\n      switchMap(() => {\n        return this.http.get<Recipe[]>(\n          \"https://angular-cooking-app-2a43c-default-rtdb.europe-west1.firebasedatabase.app/recipes.json\"\n        );\n      }),\n      map((recipes) => {\n        return recipes.map((recipe) => {\n          return {\n            ...recipe,\n            ingredients: recipe.ingredients ? recipe.ingredients : [],\n          };\n        });\n      }),\n      map((recipes) => {\n        return new RecipesActions.SetRecipes(recipes);\n      })\n    )\n  );\n\n  storeRecipes = createEffect(\n    () =>\n      this.actions$.pipe(\n        ofType(RecipesActions.STORE_RECIPES),\n        withLatestFrom(this.store.select(\"recipes\")),\n        switchMap([actionData, recipesState] => {\n          return this.http.put(\n            \"https://angular-cooking-app-2a43c-default-rtdb.europe-west1.firebasedatabase.app/recipes.json\",\n            recipes\n          );\n        })\n      ),\n    { dispatch: false }\n  );\n\n  constructor(\n    private actions$: Actions,\n    private http: HttpClient,\n    private store: Store<fromApp.AppState>\n  ) {}\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}